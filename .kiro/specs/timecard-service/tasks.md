# 実装計画

- [ ] 1. プロジェクト基盤とコンテナ環境設定

  - Rust プロジェクトの初期化と Axum、SQLx、tokio などの依存関係設定
  - Docker Compose での PostgreSQL、Redis、アプリケーションコンテナ設定
  - 基本的なプロジェクト構造（src/models, src/handlers, src/services 等）の構築
  - 開発環境用の Dockerfile と docker-compose.yml の作成
  - _要件: 9.1, 7.1_

- [ ] 2. データモデルとデータベーススキーマの実装

  - Employee、TimeRecord、Terminal の構造体定義と SQLx マッピング
  - データベースマイグレーションスクリプトの作成と実行
  - 基本的な CRUD 操作のリポジトリパターン実装
  - _要件: 1.1, 2.1, 6.2_

- [ ] 3. 認証システムの実装

  - JWT 認証ミドルウェアの実装
  - ログイン/ログアウト API エンドポイントの作成
  - パスワードハッシュ化とトークン検証機能の実装
  - 認証失敗時のアカウントロック機能の実装
  - _要件: 8.1, 8.2, 8.3_

- [ ] 4. 基本的な打刻 API 実装

  - 出勤打刻 API エンドポイント（POST /api/timecard/clock-in）の実装
  - 退勤打刻 API エンドポイント（POST /api/timecard/clock-out）の実装
  - 打刻状態取得 API（GET /api/timecard/status/{employee_id}）の実装
  - 重複打刻チェックと勤務時間計算ロジックの実装
  - _要件: 1.4, 1.5, 2.4, 2.5_

- [ ] 5. 端末通信機能の実装

  - NFC 打刻 API エンドポイント（POST /api/timecard/nfc-clock）の実装
  - QR コード打刻 API エンドポイント（POST /api/timecard/qr-clock）の実装
  - 端末登録・管理 API（POST /api/terminal/register, GET /api/admin/terminals）の実装
  - 端末ハートビート機能（POST /api/terminal/heartbeat）の実装
  - _要件: 1.1, 1.2, 1.3, 2.1, 2.2, 2.3, 6.1, 6.2_

- [ ] 6. NFC 登録・管理機能の実装

  - 打刻端末での従業員・管理者ログイン API（POST /api/terminal/login, POST /api/terminal/admin/login）の実装
  - NFC 登録 API エンドポイント（POST /api/terminal/nfc-register）の実装
  - NFC 更新 API エンドポイント（PUT /api/terminal/nfc-update）の実装
  - NFC 重複チェックとバリデーション機能の実装
  - _要件: 8.1, 8.2, 8.3, 8.4, 8.5, 8.6_

- [ ] 7. 勤怠履歴機能の実装

  - 個人勤怠履歴取得 API（GET /api/timecard/history/{employee_id}）の実装
  - 月別履歴取得 API（GET /api/timecard/history/{employee_id}/{year}/{month}）の実装
  - 勤怠データの集計とフィルタリング機能の実装
  - _要件: 3.1, 3.2, 3.3_

- [ ] 8. 管理者機能の実装

  - 全従業員勤怠状況取得 API（GET /api/admin/employees）の実装
  - 管理者ダッシュボードデータ API（GET /api/admin/dashboard）の実装
  - 勤怠データ CSV エクスポート機能（GET /api/admin/export）の実装
  - 期間指定による勤怠データ取得機能の実装
  - _要件: 4.1, 4.2, 4.3, 5.1, 5.2, 5.3_

- [ ] 9. エラーハンドリングとバリデーション

  - AppError 型の実装と Axum でのエラーレスポンス統一
  - 入力データのバリデーション機能の実装
  - 端末オフライン検知とアラート機能の実装
  - データ整合性チェック機能の実装
  - _要件: 1.6, 2.6, 6.3, 7.4_

- [ ] 10. React.js フロントエンドの基盤構築

  - React + TypeScript + DaisyUI プロジェクトの初期化
  - 基本的なルーティング設定（React Router）
  - 認証コンテキストとプライベートルートの実装
  - API クライアント（axios）の設定とエラーハンドリング
  - _要件: 9.1_

- [ ] 11. Storybook デザインシステムの構築

  - Storybook の初期設定とアドオン（a11y、controls、docs）の導入
  - DaisyUI ベースの基本コンポーネントライブラリの作成
  - デザイントークン（色、フォント、スペーシング）の定義
  - インタラクションテストとアクセシビリティチェックの設定
  - _要件: VibeCoding 対応、デザイン統一_

- [ ] 12. ログインページとレイアウトの実装

  - DaisyUI を使用したログインフォームコンポーネントの作成
  - 共通レイアウト（ナビゲーション、サイドバー）の実装
  - レスポンシブデザインの適用
  - ログイン状態管理とリダイレクト機能の実装
  - _要件: 9.1, 9.2_

- [ ] 13. 従業員ダッシュボードの実装

  - 従業員用ダッシュボードページの作成
  - 出勤・退勤打刻ボタンの実装
  - 現在の勤務状態表示機能の実装
  - 勤怠履歴テーブルコンポーネントの作成
  - _要件: 1.4, 2.4, 3.1, 3.2_

- [ ] 14. 管理者ダッシュボードの実装

  - 管理者用ダッシュボードページの作成
  - 全従業員の勤怠状況一覧表示の実装
  - 従業員詳細勤怠履歴モーダルの実装
  - 期間指定フィルター機能の実装
  - _要件: 4.1, 4.2, 4.3_

- [ ] 15. データエクスポート機能の実装

  - CSV エクスポートボタンとダウンロード機能の実装
  - エクスポート期間指定フォームの作成
  - エクスポート進行状況の表示機能の実装
  - _要件: 5.1, 5.2, 5.3_

- [ ] 16. 端末管理画面の実装

  - 端末一覧表示ページの作成
  - 端末登録フォームの実装
  - 端末状態（オンライン/オフライン）のリアルタイム表示
  - 端末設定変更機能の実装
  - _要件: 6.1, 6.2, 6.3_

- [ ] 17. リアルタイム機能の実装

  - Server-Sent Events を使用したリアルタイム更新機能の実装
  - 端末状態変更の即座反映機能の実装
  - 打刻完了通知のリアルタイム表示機能の実装
  - _要件: 6.3, 7.3_

- [ ] 18. テストの実装

  - API エンドポイントの単体テスト作成
  - データベース操作のテスト作成
  - 認証フローの統合テスト作成
  - React コンポーネントのテスト作成
  - Storybook インタラクションテストの作成
  - _要件: 全要件のテストカバレッジ_

- [ ] 19. 端末用 UI の実装

  - 端末専用の大きなボタン UI の作成
  - NFC 読み取り待機画面の実装
  - QR コード表示・読み取り画面の実装
  - 手動入力フォームの実装
  - 打刻完了・エラー表示画面の実装
  - 管理者モード画面（NFC 登録・更新）の実装
  - _要件: 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 8.2, 8.3, 8.4, 8.5_

- [ ] 20. データ同期とオフライン対応

  - 端末のローカルデータ保存機能の実装
  - ネットワーク復旧時の自動同期機能の実装
  - データ整合性チェックとエラー通知機能の実装
  - _要件: 7.2, 7.3, 7.4_

- [ ] 21. Kubernetes デプロイメント設定
  - 本番環境用の Kubernetes マニフェスト（Deployment、Service、Ingress）の作成
  - ConfigMap と Secret による設定管理の実装
  - PostgreSQL の StatefulSet と PersistentVolume の設定
  - Helm チャートの作成と CI/CD パイプラインの構築
  - _要件: 本番環境 k8s 対応_
